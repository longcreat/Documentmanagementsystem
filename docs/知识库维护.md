# AI 知识库维护管理功能

## 一、产品定位

### 1.1 为什么要做这个功能？

**问题现状**：
- 酒店AI客服每天约15-20%的问题无法准确回答
- 知识缺口分散在数千条对话中，维护人员难以发现
- 发现问题后不知道应该补充到知识库的哪个位置
- 补充后无法验证是否真正解决问题

**业务价值**：
- 让酒店知识库维护人员第一时间发现AI答不上来的问题；
- 自动推荐补充位置；
- 建立"发现→补齐→验证"的完整闭环。

### 1.2 目标用户

**酒店知识库维护人员**
- 负责维护本酒店AI客服知识库的完整性
- 核心痛点：不知道哪些内容缺失，只能被动等待反馈
- 核心期望：主动发现问题，快速定位位置，看到工作成果


## 二、核心用户场景

### 场景1：处理高频问题

```
维护人员登录
→ 在「待处理」列表顶部看到「健身房开放时间」被标记为 🔴 高优先级
→ 列表中显示：近期被多名住客反复提问
→ 系统推荐【设施信息 > 运动设施 > 健身室】，并以 🤖 状态标记为「AI 智能推荐」
→ 点击「立即补齐」
→ 自动跳转到文档，高亮「开放时间」字段
→ 填写「6:00-23:00」并保存
→ 当前知识缺口自动标记为「已处理」
```

### 场景2：处理模糊分类

```
看到「可以预订景点门票吗」
→ AI 推荐【前台服务】，并以 ⚠️ 状态提示「建议确认分类」
→ 维护人员确认分类后，发现现有文档中没有对应字段
→ 在文档中添加自定义字段「景点门票预订」
→ 填写内容：代订免费，门票原价，需提前 1 天
→ 保存完成，该知识缺口标记为「已处理」
```


### 场景3：验证补齐效果

```
查看「已处理」列表
→ 部分条目标记为「✓ 补齐后暂未再次出现」
→ 部分条目标记为「⚠️ 补齐后仍有新提问」

点击查看一条「仍有提问」的问题
→ 原问题：「SPA 营业时间」，原补充内容为「10:00-22:00」
→ 新提问：「SPA 周末营业吗？」
→ 完善内容：「每天 10:00-22:00（含周末和节假日）」
→ 保存后，重新标记为「已处理」
```

---

## 三、功能规则

### 3.1 知识缺口捕获规则

**数据来源**：
- 系统定期将 **AI Agent 的历史对话日志** 提供给大模型（LLM）进行离线审查；
- 审查粒度以「一整场会话」为单位（包含多轮用户提问与 AI 回复）；
- LLM 在每场会话中，识别并提取「因酒店静态知识库欠缺而未能被 AI 有效回答」的 QA 对数组（用户提问 + 当时 AI 回复片段）。

**记录为知识缺口的条件**（满足全部条件）：
- 该轮用户发言是一个与酒店业务相关的 **有效问题**（而非寒暄、情绪宣泄、纯聊天等）；
- 从产品视角判断，该问题**理论上应该由酒店静态知识库回答得到**（例如酒店基础信息、房型、设施、政策等），而不是天气、医院、实时价格等动态信息；
- 在当前会话中，AI Agent 基于现有静态知识库 **没有给出有效回答**，表现为：未回答、明显答偏、仅给出兜底话术等；

**不记录的情况**：
- 纯社交寒暄（例如：你好、谢谢、再见等）；
- 与酒店静态知识无关、超出知识库覆盖范围的问题（例如：天气、医院、机票预订等）；
- 明确的转人工请求（例如：转人工、找客服、找真人等）；
- 明显的测试内容或无实际业务含义的输入（例如：test、测试、123 等）。

**单场会话内的聚合规则**：
- 在同一场对话中，用户可能用不同表述多次追问同一个问题，例如多次询问「健身房开放时间」；
- LLM 负责在该场会话内部将这些表述对齐为同一个问题意图；
- 产品侧规则：
  - 同一场会话内，针对同一个问题意图（同一问题主题），**最多记 1 次知识缺口触发**。

**跨会话的聚合与合并规则**：
- 对所有会话中被提取出来的知识缺口 QA 对数组，系统首先基于**已有业务分类结构**（如：酒店基础信息 / 房型信息 / 设施信息 / 政策信息 / 自定义类别等），为每条 QA 对确定所属分类；
- 在同一业务分类桶内，由 LLM 为每条 QA 对输出一个简洁的「问题主题」文本（例如：健身房开放时间、儿童早餐收费等），系统不再对该文本做二次加工；
- 系统以「所属业务分类 + 问题主题」作为聚合维度，将不同会话中属于同一类问题的知识缺口记录进行汇总，用于后续的优先级排序和列表展示；
- 如 LLM 提示某些问题主题可能相互关联，可在后台标记为「可能相关」，由酒店知识库维护人员在管理界面中决定是否合并为同一个知识缺口；
- 业务含义明显不同的问题，始终作为不同的知识缺口独立管理。

### 3.2 AI智能分类

| 系统标记 | 含义 | 操作 |
|----------|------|------|
| 🤖 AI 智能推荐 | 模型判断较为可靠，推荐结果通常正确，可直接用于补齐 | [确认并补齐] [修改分类] |
| ⚠️ 建议确认 | 模型存在不确定性，推荐结果需要维护人员确认后再补齐 | [确认分类] [重新选择分类] |
| ⚠️ 需要人工打标 | 模型无法给出可靠推荐，需要由维护人员完整选择分类和位置 | [人工选择分类] |

**推荐精确度**：
1. 最精确：推荐到具体字段
2. 次之：推荐到subsection
3. 再次：推荐到section
4. 最宽泛：推荐到category

### 3.3 优先级排序

**可选排序**：
- 按提问次数
- 按最近时间
- 按创建时间

### 3.4 状态流转

```
待处理 → 已处理（补齐并保存）
待处理 → 已忽略（标记忽略）
```

**特殊规则**：
- 只确认分类未补齐 → 仍是"待处理"
- "已忽略"默认不显示

### 3.5 快速补齐流程

**跳转前检查**：
1. 分类是否确认？未确认 → 提示先确认
2. 目标文档是否存在？不存在 → 引导创建
3. 目标字段是否存在？不存在 → 引导添加自定义字段

**跳转后自动操作**：
1. 切换到"文档管理"标签
2. 激活对应category标签
3. 高亮目标文档
4. 打开编辑器
5. 展开section/subsection
6. 高亮并定位到目标字段
7. 顶部显示："📝 正在补齐知识缺口：XXX"

**保存后处理**：
- 点击"保存并完成" → 自动返回列表，标记为"已处理"
- 普通保存 → 关闭时询问是否标记完成




